<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>files - sp console panel</title>
    <link rel="stylesheet" href="statics/css/bootstrap.min.css">
    <link rel="stylesheet" href="statics/css/main.css">
</head>
<body>

<header><a href="/">Welcome to sp console panel !</a><a href="javascript:void(0)" id="logout" class="float-right">log out</a></header>

<div class="container-fluid">

    <div class="row">

        <div class="col-1">

            <div class="list-group">
                <a href="/pp.html" class="list-group-item list-group-item-action">pp list</a>
                <a href="/files.html" class="list-group-item list-group-item-action active">files</a>
                <a href="/setting.html" class="list-group-item list-group-item-action">setting</a>
            </div>

        </div>

        <div class="col-11">

            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th style="width:3%" scope="col">#ID</th>
                        <th style="width:15%" scope="col">name</th>
                        <th style="width:15%" scope="col">owner</th>
                        <th style="width:25%" scope="col">info</th>
                        <th style="width:4%" scope="col">state</th>
                        <th style="width:7%" scope="col">operation</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

    </div>

</div>

<span clas="oi"></span>
<script src="statics/js/jquery-3.3.1.min.js"></script>
<script src="statics/js/bootstrap.min.js"></script>
<script src="statics/js/main.js"></script>
<script src="statics/js/table.js"></script>
<script type="text/javascript">
$(function() {
    API.call("GET", "/file", {}, function(response) {
        if (response.errcode == 200 && response.data.length > 0) {
            $.each(response.data, function(idx, item) {

                t = new Date(item.time*1000)

                info = "<ul style=\"margin: 0;\">"
                info += "<li>hash: "+item.hash+"</li>"
                info += "<li>size: "+item.size+"</li>"
                info += "<li>slice total: "+item.slice_num+"</li>"
                info += "<li>upload time: "+t.getFullYear()+"/"+t.getMonth()+"/"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+"</li>"
                info += "</ul>"

                n = "<a target=\"_blank\" href=\"/slices.html?hash="+item.hash+"\">"+item.name+"</a>"
                state = item.state == 1 ? "<span class=\"text-success\">normal</span>" : "<span class=\"text-danger\">exception</span>"
                operation = "<a href=\"\" class=\"badge badge-info\">transfer</a>&nbsp;&nbsp;"
                operation += "<a href=\"\" class=\"badge badge-danger\">delete</a>"

                row = [item.id, n, item.owner, info, state, operation]

                $("tbody").addRow(row)
            })
        }
    })
})
</script>
</body>
</html>
